<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ç”Ÿæ—¥å¿«ä¹</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: black;
  touch-action: none;
  user-select: none;
}
canvas { display: block; }

#startScreen {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 4em;
  color: white;
  text-align: center;
  cursor: pointer;
  animation: bounce 1s infinite alternate;
}
#startScreen span {
  display: block;
  font-size: 0.35em;
  margin-top: 10px;
}

@keyframes bounce {
  from { transform: translate(-50%, -50%) scale(1); }
  to   { transform: translate(-50%, -60%) scale(1.15); }
}

#finalMessage {
  position: absolute;
  top: 45%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 4em;
  font-weight: bold;
  background: linear-gradient(90deg, pink, hotpink, orange);
  -webkit-background-clip: text;
  color: transparent;
  display: none;
  animation: glow 2s infinite;
  pointer-events: none;
}

@keyframes glow {
  0% { filter: drop-shadow(0 0 5px hotpink); }
  50% { filter: drop-shadow(0 0 25px pink); }
  100% { filter: drop-shadow(0 0 5px hotpink); }
}
</style>
</head>
<body>

<div id="startScreen">ğŸ‘†<span></span></div>
<div id="finalMessage"></div>
<canvas id="canvas"></canvas>

<script>
const NAME = "ç»šä¸½";

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

document.getElementById("finalMessage").innerText = `ğŸ‰ ç”Ÿæ—¥å¿«ä¹ï¼Œ${NAME}ï¼ ğŸ‰`;

class Particle {
  constructor(x, y, vx, vy, color, size=2) {
    this.x = x;
    this.y = y;
    this.vx = vx;
    this.vy = vy;
    this.alpha = 1;
    this.color = color;
    this.size = size;
  }
  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.vy += 0.03;
    this.alpha -= 0.012;
  }
  draw() {
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

let particles = [];
let started = false;
let messageShown = false;

/* ğŸ’¥ é«˜è´¨é‡çƒŸèŠ± */
function firework(x, y, count=120) {
  const hue = Math.random() * 360;
  for (let i = 0; i < count; i++) {
    const angle = Math.random() * Math.PI * 2;
    const speed = Math.random() * 6 + 2;
    particles.push(new Particle(
      x, y,
      Math.cos(angle) * speed,
      Math.sin(angle) * speed,
      `hsl(${hue},100%,60%)`,
      2
    ));
  }
}

/* ğŸ’– å¿ƒå½¢ + åå­—ï¼ˆçœŸæ­£èåˆï¼‰ */
function heartWithName(cx, cy) {
  const heartPts = [];
  for (let t = 0; t < Math.PI * 2; t += 0.08) {
    const x = 16 * Math.pow(Math.sin(t), 3);
    const y = -(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));
    heartPts.push({x: x*4, y: y*4});
  }

  // å¿ƒå½¢è½®å»“
  heartPts.forEach(p => {
    particles.push(new Particle(
      cx, cy,
      p.x * 0.03,
      p.y * 0.03,
      "hotpink",
      2.2
    ));
  });

  // åå­—ï¼ˆåœ¨å¿ƒå½¢å†…éƒ¨ï¼‰
  const temp = document.createElement("canvas");
  temp.width = 300;
  temp.height = 120;
  const tctx = temp.getContext("2d");
  tctx.font = "bold 64px Arial";
  tctx.textAlign = "center";
  tctx.textBaseline = "middle";
  tctx.fillText(NAME, 150, 60);

  const img = tctx.getImageData(0,0,300,120).data;
  for (let y = 0; y < 120; y += 4) {
    for (let x = 0; x < 300; x += 4) {
      if (img[(y*300+x)*4+3] > 150) {
        particles.push(new Particle(
          cx + x - 150,
          cy + y - 60,
          (Math.random()-0.5)*0.8,
          (Math.random()-0.5)*0.8,
          "pink",
          1.8
        ));
      }
    }
  }
}

/* åŠ¨ç”» */
function animate() {
  ctx.fillStyle = "rgba(0,0,0,0.15)";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  for (let i = particles.length-1; i>=0; i--) {
    particles[i].update();
    particles[i].draw();
    if (particles[i].alpha <= 0) particles.splice(i,1);
  }
  requestAnimationFrame(animate);
}
animate();

/* å¯åŠ¨ */
document.getElementById("startScreen").onclick = () => {
  document.getElementById("startScreen").style.display = "none";
  started = true;
  setInterval(()=>firework(Math.random()*canvas.width, Math.random()*canvas.height*0.6), 400);
  setTimeout(()=>{
    document.getElementById("finalMessage").style.display="block";
    messageShown = true;
  }, 8000);
};

/* äº¤äº’ */
canvas.addEventListener("click", e=>{
  if (!started || !messageShown) return;
  firework(e.clientX, e.clientY, 150);
});

canvas.addEventListener("dblclick", e=>{
  if (!started || !messageShown) return;
  heartWithName(e.clientX, e.clientY);
});

onresize = ()=>{
  canvas.width = innerWidth;
  canvas.height = innerHeight;
};
</script>

</body>
</html>
